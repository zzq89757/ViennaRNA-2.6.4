<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Predicting various Thermodynamic Properties &mdash; ViennaRNA Package</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/vrna_32.png"/>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script defer="defer" src="../_static/js/mathjax/tex-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deprecated Interface for Global Partition Function Computation" href="global_deprecated.html" />
    <link rel="prev" title="Local (sliding window) Partition Function and Equilibrium Probabilities" href="window.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ViennaRNA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage and Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manpages.html">Manpages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_rnalib.html">Using RNAlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">I/O Formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RNAlib API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">Concepts and Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../eval.html">Free Energy Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grammar.html">The RNA Folding Grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../landscape.html">The RNA Secondary Structure Landscape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mfe.html">Minimum Free Energy (MFE) Algorithms</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../pf_fold.html">Partition Function and Equilibrium Properties</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="global.html">Global Partition Function and Equilibrium Probabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="window.html">Local (sliding window) Partition Function and Equilibrium Probabilities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Predicting various Thermodynamic Properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermodynamic-properties-api">Thermodynamic Properties API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="global_deprecated.html">Deprecated Interface for Global Partition Function Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="window_deprecated.html">Deprecated Interface for Local (Sliding Window) Partition Function Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pf_fold.html#partition-function-api">Partition Function API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pf_fold.html#general-partition-function-api">General Partition Function API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../subopt_and_representatives.html">Suboptimals and Representative Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cofold.html">RNA-RNA Interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../class_fold.html">Classified Dynamic Programming Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inverse.html">Inverse Folding (Design)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probing_data.html">Experimental Structure Probing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ligand_binding.html">Ligands Binding to RNA Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../paired_modules.html">Structure Modules and Pseudoknots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modified_bases.html">Post-transcriptional Base Modifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vrna_3.0.html">RNAlib API v3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../callbacks.html">Callback Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated.html">Deprecated List</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers.html">SWIG Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_python.html">Python API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html">What's new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                Links
            
            </span>
        </p>
        <ul>
            
                
                    <li class="toctree-l1"><a href="https://github.com/ViennaRNA/ViennaRNA"><i class="fa fa-github fa-fw"></i> Source code</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/ViennaRNA/ViennaRNA/issues"><i class="fa fa-bug fa-fw"></i> Issue tracker</a></li>
                
            
        </ul>
    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ViennaRNA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">Concepts and Algorithms</a> &raquo;</li>
          <li><a href="../pf_fold.html">Partition Function and Equilibrium Properties</a> &raquo;</li>
      <li>Predicting various Thermodynamic Properties</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="predicting-various-thermodynamic-properties">
<h1>Predicting various Thermodynamic Properties<a class="headerlink" href="#predicting-various-thermodynamic-properties" title="Permalink to this headline"></a></h1>
<p>Compute various thermodynamic properties using the partition function.</p>
<p>Many thermodynamic properties can be derived from the partition function</p>
<div class="math notranslate nohighlight">
\[Z = \sum_{s \in \omega} e^{\frac{-E(s)}{kT}}.\]</div>
<p>In particular, for nucleic acids in equilibrium the probabilty <span class="math notranslate nohighlight">\(p(F)\)</span>
of a particular structural feature <span class="math notranslate nohighlight">\(F\)</span> follows Boltzmanns law, i.e.:</p>
<div class="math notranslate nohighlight">
\[p(F) \propto \sum_{s \mid F \in s} e^{\frac{-E(s)}{kT}}.\]</div>
<p>The actual probabilities can then be obtained from the ratio of those
structures containing <span class="math notranslate nohighlight">\(F\)</span> and <em>all</em> structures, i.e.</p>
<div class="math notranslate nohighlight">
\[p(F) = \frac{1}{Z} \sum_{s \mid F \in s} e^{\frac{-E(s)}{kT}}.\]</div>
<p>Consequently, a particular secondary structure <span class="math notranslate nohighlight">\(s\)</span> has equilibrium
probability</p>
<div class="math notranslate nohighlight">
\[p(s) = \frac{1}{Z} e^{\frac{-E(s)}{kT}}\]</div>
<p>which can be easily computed once <span class="math notranslate nohighlight">\(Z\)</span> and <span class="math notranslate nohighlight">\(E(s)\)</span> are known.</p>
<p>Efficient dynamic programming algorithms exist to compute the equilibrium
probabilities</p>
<div class="math notranslate nohighlight">
\[p_{ij} = \frac{1}{Z} \sum_{s \mid (i,j) \in s} e^{\frac{-E(s)}{kT}}\]</div>
<p>of base pairs <span class="math notranslate nohighlight">\((i,j)\)</span> without the need for exhaustive enumeration
of <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>This interface provides the functions for all thermodynamic property
computations implemented in <em>RNAlib</em>.</p>
<section id="thermodynamic-properties-api">
<h2>Thermodynamic Properties API<a class="headerlink" href="#thermodynamic-properties-api" title="Permalink to this headline"></a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__thermodynamics"></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-base-pair-probabilities-and-derived-computations">Base pair probabilities and derived computations</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_pairing_probs">
<span class="target" id="group__thermodynamics_1gaf3733c2244379f9954365d021b50ef4c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_pairing_probs</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">structure</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_pairing_probs" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_mean_bp_distance_pr">
<span class="target" id="group__thermodynamics_1gad3f0c240512e6d43e2e4d4c2076021f5"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_mean_bp_distance_pr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span>, <a class="reference internal" href="../utils/data_structures.html#c.FLT_OR_DBL" title="FLT_OR_DBL"><span class="n"><span class="pre">FLT_OR_DBL</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_mean_bp_distance_pr" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Get the mean base pair distance in the thermodynamic ensemble from a probability matrix. </p>
<p><div class="math notranslate nohighlight">
\[ &lt;d&gt; = \sum_{a,b} p_a p_b d(S_a,S_b) \]</div>
</p>
<p>this can be computed from the pair probs <span class="math notranslate nohighlight">\( p_{ij} \)</span> as</p>
<p><div class="math notranslate nohighlight">
\[ &lt;d&gt; = \sum_{ij} p_{ij}(1-p_{ij}) \]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> – The length of the sequence </p></li>
<li><p><strong>pr</strong> – The matrix containing the base pair probabilities </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean pair distance of the structure ensemble </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_mean_bp_distance">
<span class="target" id="group__thermodynamics_1gafd9ef9f1a5f0ab31540e4c3d78addc82"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_mean_bp_distance</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_mean_bp_distance" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Get the mean base pair distance in the thermodynamic ensemble. </p>
<p><div class="math notranslate nohighlight">
\[ &lt;d&gt; = \sum_{a,b} p_a p_b d(S_a,S_b) \]</div>
</p>
<p>this can be computed from the pair probs <span class="math notranslate nohighlight">\(p_{ij}\)</span> as</p>
<p><div class="math notranslate nohighlight">
\[ &lt;d&gt; = \sum_{ij} p_{ij}(1-p_{ij}) \]</div>
</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000148"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as method <code class="docutils literal notranslate"><a class="reference internal" href="global_deprecated.html#group__part__func__global__deprecated_1ga79cbc375af65f11609feb6b055269e7d"><span class="std std-ref"><span class="pre">mean_bp_distance()</span></span></a></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.mean_bp_distance" title="RNA.fold_compound.mean_bp_distance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.mean_bp_distance()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – The fold compound data structure </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean pair distance of the structure ensemble</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_ensemble_defect_pt">
<span class="target" id="group__thermodynamics_1ga20b7a56fa9e451461805fd968c6cd909"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_ensemble_defect_pt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">short</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_ensemble_defect_pt" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Compute the Ensemble Defect for a given target structure provided as a <strong>vrna_ptable</strong>. </p>
<p>Given a target structure <span class="math notranslate nohighlight">\(s\)</span>, compute the average dissimilarity of a randomly drawn structure from the ensemble, i.e.:</p>
<p><div class="math notranslate nohighlight">
\[ ED(s) = 1 - \frac{1}{n} \sum_{ij, (i,j) \in s} p_{ij} - \frac{1}{n} \sum_{i}(1 - s_i)q_i \]</div>
</p>
<p>with sequence length <span class="math notranslate nohighlight">\(n\)</span>, the probability <span class="math notranslate nohighlight">\(p_{ij}\)</span> of a base pair <span class="math notranslate nohighlight">\((i,j)\)</span>, the probability <span class="math notranslate nohighlight">\(q_i = 1 - \sum_j p_{ij}\)</span> of nucleotide <span class="math notranslate nohighlight">\(i\)</span> being unpaired, and the indicator variable <span class="math notranslate nohighlight">\(s_i = 1\)</span> if <span class="math notranslate nohighlight">\(\exists (i,j) \in s\)</span>, and <span class="math notranslate nohighlight">\(s_i = 0\)</span> otherwise.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000149"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as overloaded method <code class="docutils literal notranslate"><span class="pre">ensemble_defect()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.ensemble_defect" title="RNA.fold_compound.ensemble_defect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.ensemble_defect()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="global.html#group__part__func__global_1gaff6fe7a499a62d62d10cb850d5222f00"><span class="std std-ref">vrna_pf()</span></a>, vrna_pairing_probs(), <a class="reference internal" href="#group__thermodynamics_1gaaf197722d1faa86af5e7b4240acafdee"><span class="std std-ref">vrna_ensemble_defect()</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – A fold_compound with pre-computed base pair probabilities </p></li>
<li><p><strong>pt</strong> – A pair table representing a target structure </p></li>
</ul>
</dd>
<dt class="field-even">Pre</dt>
<dd class="field-even"><p>The <a class="reference internal" href="../utils/datastructures/fold_compound.html#group__fold__compound_1ga1b0cef17fd40466cef5968eaeeff6166"><span class="std std-ref">vrna_fold_compound_t</span></a> input parameter <code class="docutils literal notranslate"><span class="pre">fc</span></code> must contain a valid base pair probability matrix. This means that partition function and base pair probabilities must have been computed using <code class="docutils literal notranslate"><span class="pre">fc</span></code> before execution of this function!</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The ensemble defect with respect to the target structure, or -1. upon failure, e.g. pre-conditions are not met</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_ensemble_defect">
<span class="target" id="group__thermodynamics_1gaaf197722d1faa86af5e7b4240acafdee"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_ensemble_defect</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">structure</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_ensemble_defect" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Compute the Ensemble Defect for a given target structure. </p>
<p>This is a wrapper around <strong><a class="reference internal" href="#group__thermodynamics_1ga20b7a56fa9e451461805fd968c6cd909"><span class="std std-ref">vrna_ensemble_defect_pt()</span></a></strong>. Given a target structure <span class="math notranslate nohighlight">\(s\)</span>, compute the average dissimilarity of a randomly drawn structure from the ensemble, i.e.:</p>
<p><div class="math notranslate nohighlight">
\[ ED(s) = 1 - \frac{1}{n} \sum_{ij, (i,j) \in s} p_{ij} - \frac{1}{n} \sum_{i}(1 - s_i)q_i \]</div>
</p>
<p>with sequence length <span class="math notranslate nohighlight">\(n\)</span>, the probability <span class="math notranslate nohighlight">\(p_{ij}\)</span> of a base pair <span class="math notranslate nohighlight">\((i,j)\)</span>, the probability <span class="math notranslate nohighlight">\(q_i = 1 - \sum_j p_{ij}\)</span> of nucleotide <span class="math notranslate nohighlight">\(i\)</span> being unpaired, and the indicator variable <span class="math notranslate nohighlight">\(s_i = 1\)</span> if <span class="math notranslate nohighlight">\(\exists (i,j) \in s\)</span>, and <span class="math notranslate nohighlight">\(s_i = 0\)</span> otherwise.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000150"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as method <code class="docutils literal notranslate"><span class="pre">ensemble_defect()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. Note that the SWIG wrapper takes a structure in dot-bracket notation and converts it into a pair table using <a class="reference internal" href="../utils/struct/pairtable.html#group__struct__utils__pair__table_1ga792503f8b2c6783248e5c8b3d56e9148"><span class="std std-ref">vrna_ptable_from_string()</span></a>. The resulting pair table is then internally passed to <a class="reference internal" href="#group__thermodynamics_1ga20b7a56fa9e451461805fd968c6cd909"><span class="std std-ref">vrna_ensemble_defect_pt()</span></a>. To control which kind of matching brackets will be used during conversion, the optional argument <code class="docutils literal notranslate"><span class="pre">options</span></code> can be used. See also the description of <a class="reference internal" href="../utils/struct/pairtable.html#group__struct__utils__pair__table_1ga792503f8b2c6783248e5c8b3d56e9148"><span class="std std-ref">vrna_ptable_from_string()</span></a> for available options. (default: <code class="docutils literal notranslate"><span class="pre">VRNA_BRACKETS_RND</span></code>). See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.ensemble_defect" title="RNA.fold_compound.ensemble_defect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.ensemble_defect()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="global.html#group__part__func__global_1gaff6fe7a499a62d62d10cb850d5222f00"><span class="std std-ref">vrna_pf()</span></a>, vrna_pairing_probs(), <a class="reference internal" href="#group__thermodynamics_1ga20b7a56fa9e451461805fd968c6cd909"><span class="std std-ref">vrna_ensemble_defect_pt()</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – A fold_compound with pre-computed base pair probabilities </p></li>
<li><p><strong>structure</strong> – A target structure in dot-bracket notation </p></li>
</ul>
</dd>
<dt class="field-even">Pre</dt>
<dd class="field-even"><p>The <a class="reference internal" href="../utils/datastructures/fold_compound.html#group__fold__compound_1ga1b0cef17fd40466cef5968eaeeff6166"><span class="std std-ref">vrna_fold_compound_t</span></a> input parameter <code class="docutils literal notranslate"><span class="pre">fc</span></code> must contain a valid base pair probability matrix. This means that partition function and base pair probabilities must have been computed using <code class="docutils literal notranslate"><span class="pre">fc</span></code> before execution of this function!</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The ensemble defect with respect to the target structure, or -1. upon failure, e.g. pre-conditions are not met</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_positional_entropy">
<span class="target" id="group__thermodynamics_1ga4ec346141028c7bcd15bc235c408b6e9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_positional_entropy</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_positional_entropy" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Compute a vector of positional entropies. </p>
<p>This function computes the positional entropies from base pair probabilities as</p>
<p><div class="math notranslate nohighlight">
\[ S(i) = - \sum_j p_{ij} \log(p_{ij}) - q_i \log(q_i) \]</div>
</p>
<p>with unpaired probabilities <span class="math notranslate nohighlight">\( q_i = 1 - \sum_j p_{ij} \)</span>.</p>
<p>Low entropy regions have little structural flexibility and the reliability of the predicted structure is high. High entropy implies many structural alternatives. While these alternatives may be functionally important, they make structure prediction more difficult and thus less reliable.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000151"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as method <code class="docutils literal notranslate"><span class="pre">positional_entropy()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.positional_entropy" title="RNA.fold_compound.positional_entropy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.positional_entropy()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – A fold_compound with pre-computed base pair probabilities </p></li>
</ul>
</dd>
<dt class="field-even">Pre</dt>
<dd class="field-even"><p>This function requires pre-computed base pair probabilities! Thus, <a class="reference internal" href="global.html#group__part__func__global_1gaff6fe7a499a62d62d10cb850d5222f00"><span class="std std-ref">vrna_pf()</span></a> must be called beforehand.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A 1-based vector of positional entropies <span class="math notranslate nohighlight">\( S(i) \)</span>. (position 0 contains the sequence length)</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_stack_prob">
<span class="target" id="group__thermodynamics_1gaa687ae9f56f5cedba1e863cd6d54af43"></span><a class="reference internal" href="../utils/struct/plist.html#c.vrna_ep_t" title="vrna_ep_t"><span class="n"><span class="pre">vrna_ep_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_stack_prob</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">cutoff</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_stack_prob" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Compute stacking probabilities. </p>
<p>For each possible base pair <span class="math notranslate nohighlight">\((i,j)\)</span>, compute the probability of a stack <span class="math notranslate nohighlight">\((i,j)\)</span>, <span class="math notranslate nohighlight">\((i+1, j-1)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – The fold compound data structure with precomputed base pair probabilities </p></li>
<li><p><strong>cutoff</strong> – A cutoff value that limits the output to stacks with <span class="math notranslate nohighlight">\( p &gt; \textrm{cutoff} \)</span>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of stacks with enclosing base pair <span class="math notranslate nohighlight">\((i,j)\)</span> and probabiltiy <span class="math notranslate nohighlight">\( p \)</span></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-multimer-probabilities-computations">Multimer probabilities computations</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_pf_dimer_probs">
<span class="target" id="group__thermodynamics_1gaa1e39e73afb51fbaf4ae38f0c066c46b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_pf_dimer_probs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">FAB</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">FA</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">FB</span></span>, <a class="reference internal" href="../utils/struct/plist.html#c.vrna_ep_t" title="vrna_ep_t"><span class="n"><span class="pre">vrna_ep_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">prAB</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../utils/struct/plist.html#c.vrna_ep_t" title="vrna_ep_t"><span class="n"><span class="pre">vrna_ep_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">prA</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../utils/struct/plist.html#c.vrna_ep_t" title="vrna_ep_t"><span class="n"><span class="pre">vrna_ep_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">prB</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">Alength</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../eval/energy_parameters.html#c.vrna_exp_param_t" title="vrna_exp_param_t"><span class="n"><span class="pre">vrna_exp_param_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">exp_params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_pf_dimer_probs" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Compute Boltzmann probabilities of dimerization without homodimers. </p>
<p>Given the pair probabilities and free energies (in the null model) for a dimer AB and the two constituent monomers A and B, compute the conditional pair probabilities given that a dimer AB actually forms. Null model pair probabilities are given as a list as produced by <a class="reference internal" href="global.html#group__part__func__global_1ga3d2a1167543c90edac4c95507e9d3383"><span class="std std-ref">vrna_plist_from_probs()</span></a>, the dimer probabilities ‘prAB’ are modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FAB</strong> – free energy of dimer AB </p></li>
<li><p><strong>FA</strong> – free energy of monomer A </p></li>
<li><p><strong>FB</strong> – free energy of monomer B </p></li>
<li><p><strong>prAB</strong> – pair probabilities for dimer </p></li>
<li><p><strong>prA</strong> – pair probabilities monomer </p></li>
<li><p><strong>prB</strong> – pair probabilities monomer </p></li>
<li><p><strong>Alength</strong> – Length of molecule A </p></li>
<li><p><strong>exp_params</strong> – The precomputed Boltzmann factors </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-structure-probability-computations">Structure probability computations</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_pr_structure">
<span class="target" id="group__thermodynamics_1ga882c35d9dd775c1275593b3b6a966bec"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_pr_structure</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">structure</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_pr_structure" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p>Compute the equilibrium probability of a particular secondary structure. </p>
<p>The probability <span class="math notranslate nohighlight">\(p(s)\)</span> of a particular secondary structure <span class="math notranslate nohighlight">\(s\)</span> can be computed as</p>
<p><div class="math notranslate nohighlight">
\[ p(s) = \frac{exp(-\beta E(s)}{Z} \]</div>
</p>
<p>from the structures free energy <span class="math notranslate nohighlight">\(E(s)\)</span> and the partition function</p>
<p><div class="math notranslate nohighlight">
\[ Z = \sum_s exp(-\beta E(s)),\quad\mathrm{with}\quad\beta = \frac{1}{RT} \]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the gas constant and <span class="math notranslate nohighlight">\(T\)</span> the thermodynamic temperature.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000152"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as method <code class="docutils literal notranslate"><span class="pre">pr_structure()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.pr_structure" title="RNA.fold_compound.pr_structure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.pr_structure()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – The fold compound data structure with precomputed partition function </p></li>
<li><p><strong>structure</strong> – The secondary structure to compute the probability for in dot-bracket notation </p></li>
</ul>
</dd>
<dt class="field-even">Pre</dt>
<dd class="field-even"><p>The fold compound <code class="docutils literal notranslate"><span class="pre">fc</span></code> must have went through a call to <a class="reference internal" href="global.html#group__part__func__global_1gaff6fe7a499a62d62d10cb850d5222f00"><span class="std std-ref">vrna_pf()</span></a> to fill the dynamic programming matrices with the corresponding partition function.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The probability of the input structure (range <span class="math notranslate nohighlight">\([0:1]\)</span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_pr_energy">
<span class="target" id="group__thermodynamics_1ga6a1e8a85e6fab2380ce235180beb85f8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_pr_energy</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">e</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_pr_energy" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/equilibrium_probs.h&gt;</em><p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000153"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as method <code class="docutils literal notranslate"><span class="pre">pr_energy()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.pr_energy" title="RNA.fold_compound.pr_energy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.pr_energy()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-basic-heat-capacity-function-interface">Basic heat capacity function interface</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_heat_capacity">
<span class="target" id="group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"></span><a class="reference internal" href="#c.vrna_heat_capacity_t" title="vrna_heat_capacity_t"><span class="n"><span class="pre">vrna_heat_capacity_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_heat_capacity</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_min</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_max</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_increment</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mpoints</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_heat_capacity" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em><p>Compute the specific heat for an RNA. </p>
<p>This function computes an RNAs specific heat in a given temperature range from the partition function by numeric differentiation. The result is returned as a list of pairs of temperature in C and specific heat in Kcal/(Mol*K).</p>
<p>Users can specify the temperature range for the computation from <code class="docutils literal notranslate"><span class="pre">T_min</span></code> to <code class="docutils literal notranslate"><span class="pre">T_max</span></code>, as well as the increment step size <code class="docutils literal notranslate"><span class="pre">T_increment</span></code>. The latter also determines how many times the partition function is computed. Finally, the parameter <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> determines how smooth the curve should be. The algorithm itself fits a parabola to <span class="math notranslate nohighlight">\( 2 \cdot mpoints + 1 \)</span> data points to calculate 2nd derivatives. Increasing this parameter produces a smoother curve.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000107"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as overloaded method <code class="docutils literal notranslate"><span class="pre">heat_capacity()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. If the optional function arguments <code class="docutils literal notranslate"><span class="pre">T_min</span></code>, <code class="docutils literal notranslate"><span class="pre">T_max</span></code>, <code class="docutils literal notranslate"><span class="pre">T_increment</span></code>, and <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> are omitted, they default to 0.0, 100.0, 1.0 and 2, respectively. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.heat_capacity" title="RNA.fold_compound.heat_capacity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.heat_capacity()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__thermodynamics_1ga19ef508fcc66ab80833aa2fe402d8927"><span class="std std-ref">vrna_heat_capacity_cb()</span></a>, <a class="reference internal" href="#group__thermodynamics_1ga99dc703d840310177ecf7aedf72b4409"><span class="std std-ref">vrna_heat_capacity_t</span></a>, <a class="reference internal" href="#structvrna__heat__capacity__s"><span class="std std-ref">vrna_heat_capacity_s</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – The <a class="reference internal" href="../utils/datastructures/fold_compound.html#group__fold__compound_1ga1b0cef17fd40466cef5968eaeeff6166"><span class="std std-ref">vrna_fold_compound_t</span></a> with the RNA sequence to analyze </p></li>
<li><p><strong>T_min</strong> – Lowest temperature in C </p></li>
<li><p><strong>T_max</strong> – Highest temperature in C </p></li>
<li><p><strong>T_increment</strong> – Stepsize for temperature incrementation in C (a reasonable choice might be 1C) </p></li>
<li><p><strong>mpoints</strong> – The number of interpolation points to calculate 2nd derivative (a reasonable choice might be 2, min: 1, max: 100) </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of pairs of temperatures and corresponding heat capacity or <em>NULL</em> upon any failure. The last entry of the list is indicated by a <strong>temperature</strong> field set to a value smaller than <code class="docutils literal notranslate"><span class="pre">T_min</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_cb">
<span class="target" id="group__thermodynamics_1ga19ef508fcc66ab80833aa2fe402d8927"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_heat_capacity_cb</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_min</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_max</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_increment</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mpoints</span></span>, <a class="reference internal" href="#c.vrna_heat_capacity_f" title="vrna_heat_capacity_f"><span class="n"><span class="pre">vrna_heat_capacity_f</span></span></a><span class="w"> </span><span class="n"><span class="pre">cb</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_heat_capacity_cb" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em><p>Compute the specific heat for an RNA (callback variant) </p>
<p>Similar to <a class="reference internal" href="#group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"><span class="std std-ref">vrna_heat_capacity()</span></a>, this function computes an RNAs specific heat in a given temperature range from the partition function by numeric differentiation. Instead of returning a list of temperature/specific heat pairs, however, this function returns the individual results through a callback mechanism. The provided function will be called for each result and passed the corresponding temperature and specific heat values along with the arbitrary data as provided through the <code class="docutils literal notranslate"><span class="pre">data</span></code> pointer argument.</p>
<p>Users can specify the temperature range for the computation from <code class="docutils literal notranslate"><span class="pre">T_min</span></code> to <code class="docutils literal notranslate"><span class="pre">T_max</span></code>, as well as the increment step size <code class="docutils literal notranslate"><span class="pre">T_increment</span></code>. The latter also determines how many times the partition function is computed. Finally, the parameter <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> determines how smooth the curve should be. The algorithm itself fits a parabola to <span class="math notranslate nohighlight">\( 2 \cdot mpoints + 1 \)</span> data points to calculate 2nd derivatives. Increasing this parameter produces a smoother curve.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000108"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as method <code class="docutils literal notranslate"><span class="pre">heat_capacity_cb()</span></code> to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.heat_capacity_cb" title="RNA.fold_compound.heat_capacity_cb"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.heat_capacity_cb()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"><span class="std std-ref">vrna_heat_capacity()</span></a>, <a class="reference internal" href="#group__thermodynamics_1gafa73325bee7e6b7c9d1732d70e67d65a"><span class="std std-ref">vrna_heat_capacity_f</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – The <a class="reference internal" href="../utils/datastructures/fold_compound.html#group__fold__compound_1ga1b0cef17fd40466cef5968eaeeff6166"><span class="std std-ref">vrna_fold_compound_t</span></a> with the RNA sequence to analyze </p></li>
<li><p><strong>T_min</strong> – Lowest temperature in C </p></li>
<li><p><strong>T_max</strong> – Highest temperature in C </p></li>
<li><p><strong>T_increment</strong> – Stepsize for temperature incrementation in C (a reasonable choice might be 1C) </p></li>
<li><p><strong>mpoints</strong> – The number of interpolation points to calculate 2nd derivative (a reasonable choice might be 2, min: 1, max: 100) </p></li>
<li><p><strong>cb</strong> – The user-defined callback function that receives the individual results </p></li>
<li><p><strong>data</strong> – An arbitrary data structure that will be passed to the callback in conjunction with the results </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns 0 upon failure, and non-zero otherwise</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-simplified-heat-capacity-computation">Simplified heat capacity computation</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_simple">
<span class="target" id="group__thermodynamics_1ga0c2664e15dded704d805a9d2a625ff21"></span><a class="reference internal" href="#c.vrna_heat_capacity_t" title="vrna_heat_capacity_t"><span class="n"><span class="pre">vrna_heat_capacity_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_heat_capacity_simple</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sequence</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_min</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_max</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">T_increment</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mpoints</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_heat_capacity_simple" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em><p>Compute the specific heat for an RNA (simplified variant) </p>
<p>Similar to <a class="reference internal" href="#group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"><span class="std std-ref">vrna_heat_capacity()</span></a>, this function computes an RNAs specific heat in a given temperature range from the partition function by numeric differentiation. This simplified version, however, only requires the RNA sequence as input instead of a vrna_fold_compound_t data structure. The result is returned as a list of pairs of temperature in C and specific heat in Kcal/(Mol*K).</p>
<p>Users can specify the temperature range for the computation from <code class="docutils literal notranslate"><span class="pre">T_min</span></code> to <code class="docutils literal notranslate"><span class="pre">T_max</span></code>, as well as the increment step size <code class="docutils literal notranslate"><span class="pre">T_increment</span></code>. The latter also determines how many times the partition function is computed. Finally, the parameter <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> determines how smooth the curve should be. The algorithm itself fits a parabola to <span class="math notranslate nohighlight">\( 2 \cdot mpoints + 1 \)</span> data points to calculate 2nd derivatives. Increasing this parameter produces a smoother curve.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000109"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is available as overloaded function <code class="docutils literal notranslate"><span class="pre">heat_capacity()</span></code>. If the optional function arguments <code class="docutils literal notranslate"><span class="pre">T_min</span></code>, <code class="docutils literal notranslate"><span class="pre">T_max</span></code>, <code class="docutils literal notranslate"><span class="pre">T_increment</span></code>, and <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> are omitted, they default to 0.0, 100.0, 1.0 and 2, respectively. See, e.g.  <span><code class="xref py py-func docutils literal notranslate"><span class="pre">RNA.head_capacity()</span></code> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"><span class="std std-ref">vrna_heat_capacity()</span></a>, <a class="reference internal" href="#group__thermodynamics_1ga19ef508fcc66ab80833aa2fe402d8927"><span class="std std-ref">vrna_heat_capacity_cb()</span></a>, <a class="reference internal" href="#group__thermodynamics_1ga99dc703d840310177ecf7aedf72b4409"><span class="std std-ref">vrna_heat_capacity_t</span></a>, <a class="reference internal" href="#structvrna__heat__capacity__s"><span class="std std-ref">vrna_heat_capacity_s</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> – The RNA sequence input (must be uppercase) </p></li>
<li><p><strong>T_min</strong> – Lowest temperature in C </p></li>
<li><p><strong>T_max</strong> – Highest temperature in C </p></li>
<li><p><strong>T_increment</strong> – Stepsize for temperature incrementation in C (a reasonable choice might be 1C) </p></li>
<li><p><strong>mpoints</strong> – The number of interpolation points to calculate 2nd derivative (a reasonable choice might be 2, min: 1, max: 100) </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of pairs of temperatures and corresponding heat capacity or <em>NULL</em> upon any failure. The last entry of the list is indicated by a <strong>temperature</strong> field set to a value smaller than <code class="docutils literal notranslate"><span class="pre">T_min</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_f">
<span class="target" id="group__thermodynamics_1gafa73325bee7e6b7c9d1732d70e67d65a"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_heat_capacity_f</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">temp</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n"><span class="pre">heat_capacity</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.vrna_heat_capacity_f" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em><p>The callback for heat capacity predictions. </p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../callbacks.html#callbacks_1_callbacks000004"><span class="std std-ref"><span class="pre">Notes</span> <span class="pre">on</span> <span class="pre">Callback</span> <span class="pre">Functions:</span></span></a></dt>
<dd><p>This function will be called for each evaluated temperature in the heat capacity prediction. </p>
</dd></dl>

</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__thermodynamics_1ga19ef508fcc66ab80833aa2fe402d8927"><span class="std std-ref">vrna_heat_capacity_cb()</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Param temp</dt>
<dd class="field-odd"><p>The current temperature this results corresponds to in C </p>
</dd>
<dt class="field-even">Param heat_capacity</dt>
<dd class="field-even"><p>The heat capacity in Kcal/(Mol * K) </p>
</dd>
<dt class="field-odd">Param data</dt>
<dd class="field-odd"><p>Some arbitrary data pointer passed through by the function executing the callback </p>
</dd>
</dl>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c">
<span class="target" id="group__thermodynamics_1ga18316e4657502e9203931f924d93732f"></span><span class="sig-name descname"><span class="pre">void()</span> <span class="pre">vrna_heat_capacity_callback</span> <span class="pre">(float</span> <span class="pre">temp,</span> <span class="pre">float</span> <span class="pre">heat_capacity,</span> <span class="pre">void</span> <span class="pre">*data)</span></span></dt>
<dd><em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em></dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_t">
<span class="target" id="group__thermodynamics_1ga99dc703d840310177ecf7aedf72b4409"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.vrna_heat_capacity_s" title="vrna_heat_capacity_s"><span class="n"><span class="pre">vrna_heat_capacity_s</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_heat_capacity_t</span></span></span><a class="headerlink" href="#c.vrna_heat_capacity_t" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em><p>A single result from heat capacity computations. </p>
<p>This is a convenience typedef for <a class="reference internal" href="#structvrna__heat__capacity__s"><span class="std std-ref">vrna_heat_capacity_s</span></a>, i.e. results as obtained from <a class="reference internal" href="#group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"><span class="std std-ref">vrna_heat_capacity()</span></a></p>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_s">
<span class="target" id="structvrna__heat__capacity__s"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrna_heat_capacity_s</span></span></span><a class="headerlink" href="#c.vrna_heat_capacity_s" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;ViennaRNA/heat_capacity.h&gt;</em></div>
<p>A single result from heat capacity computations. </p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__thermodynamics_1gafd95c2350d67d8f4374369c19cf111f1"><span class="std std-ref">vrna_heat_capacity()</span></a></p>
</div>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_s.temperature">
<span class="target" id="structvrna__heat__capacity__s_1a62ed3466ce614f4f1e729463fac41d72"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">temperature</span></span></span><a class="headerlink" href="#c.vrna_heat_capacity_s.temperature" title="Permalink to this definition"></a><br /></dt>
<dd><p>The temperature in C. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.vrna_heat_capacity_s.heat_capacity">
<span class="target" id="structvrna__heat__capacity__s_1a2987d5e5ef974d14a108ec1c7062562f"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">heat_capacity</span></span></span><a class="headerlink" href="#c.vrna_heat_capacity_s.heat_capacity" title="Permalink to this definition"></a><br /></dt>
<dd><p>The specific heat at this temperature in Kcal/(Mol * K) </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="window.html" class="btn btn-neutral float-left" title="Local (sliding window) Partition Function and Equilibrium Probabilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="global_deprecated.html" class="btn btn-neutral float-right" title="Deprecated Interface for Global Partition Function Computation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1994 - 2023, Ronny Lorenz, Ivo L. Hofacker, et al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>