<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Program switch.pl &mdash; ViennaRNA Package</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/vrna_32.png"/>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Program RNA2Dfold" href="RNA2Dfold.html" />
    <link rel="prev" title="The Program RNAinverse" href="RNAinverse.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ViennaRNA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage and Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#global-rna-secondary-structure-prediction">Global RNA Secondary Structure Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#consensus-structure-prediction">Consensus Structure Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#rna-rna-interaction">RNA-RNA interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#plotting-structures">Plotting Structures</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../getting_started.html#rna-design">RNA Design</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="RNAinverse.html">The Program <code class="docutils literal notranslate"><span class="pre">RNAinverse</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">The Program <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#designing-a-switch">Designing a Switch</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#rna-folding-kinetics">RNA folding kinetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#other-utilities">Other Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../manpages.html">Manpages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_rnalib.html">Using RNAlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">I/O Formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RNAlib API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Concepts and Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers.html">SWIG Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_python.html">Python API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html">What's new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                Links
            
            </span>
        </p>
        <ul>
            
                
                    <li class="toctree-l1"><a href="https://github.com/ViennaRNA/ViennaRNA"><i class="fa fa-github fa-fw"></i> Source code</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/ViennaRNA/ViennaRNA/issues"><i class="fa fa-bug fa-fw"></i> Issue tracker</a></li>
                
            
        </ul>
    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ViennaRNA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../getting_started.html">Getting Started</a> &raquo;</li>
      <li>The Program <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code></li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-program-switch-pl">
<h1>The Program <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code><a class="headerlink" href="#the-program-switch-pl" title="Permalink to this headline"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code> script can be used to design bi-stable structures, i.e.
structures with two almost equally good foldings. For two given structures
there are always a lot of sequences compatible with both structures. If both
structures are reasonably stable you can find sequences where both target
structures have almost equal energy and all other structures have much higher
energies.
Combined with <code class="docutils literal notranslate"><span class="pre">RNAsubopt</span></code>, <code class="docutils literal notranslate"><span class="pre">barriers</span></code> and <code class="docutils literal notranslate"><span class="pre">treekin</span></code>, this is a very
useful tool for designing RNA switches.</p>
<p>The input requires two structures in dot-bracket notation and additionally
you can add a sequence. It is also possible to calculate the switching
function at two different temperatures with option <code class="docutils literal notranslate"><span class="pre">-T</span></code> and <code class="docutils literal notranslate"><span class="pre">-T2</span></code>.</p>
</section>
<section id="designing-a-switch">
<h2>Designing a Switch<a class="headerlink" href="#designing-a-switch" title="Permalink to this headline"></a></h2>
<p>Now we try to create an RNA switch using <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code> <span id="id1">[<a class="reference internal" href="../bibliography.html#id31" title="Christoph Flamm, Ivo L Hofacker, Sebastian Maurer-Stroh, Peter F Stadler, and Martin Zehl. Design of multistable RNA molecules. RNA, 7(02):254–265, 2001. doi:10.1017/s1355838201000863.">Flamm <em>et al.</em>, 2001</a>]</span>.
First we create our inputfile, then invoke the program using ten optimization
runs  (<code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">10</span></code>) and do not allow <em>lonely pairs</em>. Write it out to <code class="docutils literal notranslate"><span class="pre">switch.out</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat &gt; switch.in
((((((((......))))))))....((((((((.......))))))))
((((((((((((((((((........)))))))))))))))))).....

$ switch.pl -n 10 --noLP &lt; switch.in &gt; switch.out
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">switch.out</span></code> should look similar like this, the first block represents our
bi-stable structures in random order, the second block shows the resulting
sequences ordered by their score.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat switch.out
GGGUGGACGUUUCGGUCCAUCCUUACGGACUGGGGCGUUUACCUAGUCC   0.9656
CAUUUGGCUUGUGUGUCGAAUGGCCCCGGUACGUAGGCUAAAUGUACCG   1.2319
GGGGGGUGCGUUCACACCCCUCAUUUGGUGUGGAUGUGCUUUCUACACU   1.1554
[...]
</pre></div>
</div>
<p>the resulting sequences are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAUUUGGCUUGUGUGUCGAAUGGCCCCGGUACGUAGGCUAAAUGUACCG</span>   <span class="mf">1.2319</span>
<span class="n">GGGGGGUGCGUUCACACCCCUCAUUUGGUGUGGAUGUGCUUUCUACACU</span>   <span class="mf">1.1554</span>
<span class="n">CGGGUUGUAACUGGAUAGCCUGGAAACUGUUUGGUUGUAAUCCGAACAG</span>   <span class="mf">1.0956</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Given all 10 suggestions in our <code class="docutils literal notranslate"><span class="pre">switch.out</span></code>, we select the one with the
best score with some command line tools to use it as an <code class="docutils literal notranslate"><span class="pre">RNAsubopt</span></code> input
file and build up the barriers tree.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tail -10 switch.out | awk &#39;{print($1)}&#39;  | head -n 1 &gt; subopt.in
$ RNAsubopt --noLP -s -e 25 &lt; subopt.in &gt; subopt.out
$ barriers -G RNA-noLP --bsize --rates --minh 2 --max 30 &lt; subopt.out &gt; barriers.out
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-10</span></code> cuts the last 10 lines from the <code class="docutils literal notranslate"><span class="pre">switch.out</span></code> file and pipes
them into an <code class="docutils literal notranslate"><span class="pre">awk</span></code> script. The function <code class="docutils literal notranslate"><span class="pre">print($1)</span></code> echoes only the first
column and this is piped into the <code class="docutils literal notranslate"><span class="pre">head</span></code> program where the first line, which
equals the best scored sequence, is taken and written into <code class="docutils literal notranslate"><span class="pre">subopt.in</span></code>.
Then <code class="docutils literal notranslate"><span class="pre">RNAsubopt</span></code> is called to process our sequence and write the output to
another file which is the input for the barriers calculation.</p>
<p>Below you find an example of the barrier tree calculation above done with the
right settings (connected root) on the left side and the wrong <code class="docutils literal notranslate"><span class="pre">RNAsubobt</span> <span class="pre">-e</span></code>
value on the right. Keep in mind that <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code> performs a stochastic search
and the output sequences are different every time because there are a lot of
sequences which fit the structure and switch calculates a new one everytime.
Simply try to make sure.</p>
<p><a class="reference internal" href="../_images/switch_barriertree.png"><img alt="bt1" src="../_images/switch_barriertree.png" style="width: 48%;" /></a> <a class="reference internal" href="../_images/switch_barriertree_e13.png"><img alt="bt2" src="../_images/switch_barriertree_e13.png" style="width: 48%;" /></a></p>
<p>left: Barriers tree as it should look like, all branches connected to the main root
right: disconnected tree due to a too low energy range (<code class="docutils literal notranslate"><span class="pre">-e</span></code>) parameter set in
<code class="docutils literal notranslate"><span class="pre">RNAsubopt</span></code>.</p>
<p>Be careful to set the range <code class="docutils literal notranslate"><span class="pre">-e</span></code> high enough, otherwise we get a problem when
calculation the kinetics using <code class="docutils literal notranslate"><span class="pre">treekin</span></code>. Every branch should be somehow connected
to the main root of the tree. Try <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">20</span></code> and <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">30</span></code> to see the difference in
the trees and choose the optimal value. By using <code class="docutils literal notranslate"><span class="pre">--max</span> <span class="pre">30</span></code> we shorten our tree
to focus only on the lowest minima.</p>
<p>We then select a branch preferably outside of the two main branches, here branch
30 (may differ from your own calculation). Look at the barrier tree to find the
best branch to start and replace <code class="docutils literal notranslate"><span class="pre">30</span></code> by the branch you would choose. Now use
<code class="docutils literal notranslate"><span class="pre">treekin</span></code> to plot concentration kinetics and think about the graph you just
created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ treekin -m I --p0 30=1  &lt; barriers.out &gt; treekin.out
$ xmgrace -log x -nxy treekin.out
</pre></div>
</div>
<p>The graph could look like the one below, remember everytime you use <code class="docutils literal notranslate"><span class="pre">switch.pl</span></code>
it can give you different sequences so the output varies too. Here the one from
the example.</p>
<a class="reference internal image-reference" href="../_images/switch_treekin.png"><img alt="../_images/switch_treekin.png" class="align-center" src="../_images/switch_treekin.png" style="width: 66%;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="RNAinverse.html" class="btn btn-neutral float-left" title="The Program RNAinverse" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="RNA2Dfold.html" class="btn btn-neutral float-right" title="The Program RNA2Dfold" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1994 - 2023, Ronny Lorenz, Ivo L. Hofacker, et al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>