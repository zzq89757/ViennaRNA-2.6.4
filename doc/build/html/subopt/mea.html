<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compute the Structure with Maximum Expected Accuracy (MEA) &mdash; ViennaRNA Package</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/vrna_32.png"/>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script defer="defer" src="../_static/js/mathjax/tex-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Compute the Centroid Structure" href="centroid.html" />
    <link rel="prev" title="Random Structure Samples from the Ensemble" href="stochbt.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ViennaRNA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage and Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manpages.html">Manpages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_rnalib.html">Using RNAlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">I/O Formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RNAlib API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">Concepts and Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../eval.html">Free Energy Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grammar.html">The RNA Folding Grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../landscape.html">The RNA Secondary Structure Landscape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mfe.html">Minimum Free Energy (MFE) Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pf_fold.html">Partition Function and Equilibrium Properties</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../subopt_and_representatives.html">Suboptimals and Representative Structures</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="zuker.html">Suboptimal Structures sensu Zuker</a></li>
<li class="toctree-l3"><a class="reference internal" href="wuchty.html">Suboptimal Structures within an Energy Band around the MFE</a></li>
<li class="toctree-l3"><a class="reference internal" href="stochbt.html">Random Structure Samples from the Ensemble</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Compute the Structure with Maximum Expected Accuracy (MEA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="centroid.html">Compute the Centroid Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cofold.html">RNA-RNA Interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../class_fold.html">Classified Dynamic Programming Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inverse.html">Inverse Folding (Design)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probing_data.html">Experimental Structure Probing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ligand_binding.html">Ligands Binding to RNA Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../paired_modules.html">Structure Modules and Pseudoknots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modified_bases.html">Post-transcriptional Base Modifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vrna_3.0.html">RNAlib API v3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../callbacks.html">Callback Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated.html">Deprecated List</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers.html">SWIG Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_python.html">Python API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html">What's new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                Links
            
            </span>
        </p>
        <ul>
            
                
                    <li class="toctree-l1"><a href="https://github.com/ViennaRNA/ViennaRNA"><i class="fa fa-github fa-fw"></i> Source code</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/ViennaRNA/ViennaRNA/issues"><i class="fa fa-bug fa-fw"></i> Issue tracker</a></li>
                
            
        </ul>
    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ViennaRNA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">Concepts and Algorithms</a> &raquo;</li>
          <li><a href="../subopt_and_representatives.html">Suboptimals and Representative Structures</a> &raquo;</li>
      <li>Compute the Structure with Maximum Expected Accuracy (MEA)</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="compute-the-structure-with-maximum-expected-accuracy-mea">
<h1>Compute the Structure with Maximum Expected Accuracy (MEA)<a class="headerlink" href="#compute-the-structure-with-maximum-expected-accuracy-mea" title="Permalink to this headline"></a></h1>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__mea__fold"></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_MEA">
<span class="target" id="group__mea__fold_1ga9b87b664ef014c1266aa50d5bc39f2ac"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_MEA</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/datastructures/fold_compound.html#c.vrna_fold_compound_t" title="vrna_fold_compound_t"><span class="n"><span class="pre">vrna_fold_compound_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">gamma</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mea</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_MEA" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/MEA.h&gt;</em><p>Compute a MEA (maximum expected accuracy) structure. </p>
<p>The algorithm maximizes the expected accuracy</p>
<p><div class="math notranslate nohighlight">
\[ A(S) = \sum_{(i,j) \in S} 2 \gamma p_{ij} + \sum_{i \notin S} p^u_i \]</div>
</p>
<p>Higher values of <span class="math notranslate nohighlight">\(\gamma\)</span> result in more base pairs of lower probability and thus higher sensitivity. Low values of <span class="math notranslate nohighlight">\(\gamma\)</span> result in structures containing only highly likely pairs (high specificity). The code of the MEA function also demonstrates the use of sparse dynamic programming scheme to reduce the time and memory complexity of folding.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000154"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is attached as overloaded method <code class="docutils literal notranslate"><span class="pre">MEA</span></code>(gamma = 1.) to objects of type <code class="docutils literal notranslate"><span class="pre">fold_compound</span></code>. Note, that it returns the MEA structure and MEA value as a tuple (MEA_structure, MEA). See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.fold_compound.MEA" title="RNA.fold_compound.MEA"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RNA.fold_compound.MEA()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – The fold compound data structure with pre-filled base pair probability matrix </p></li>
<li><p><strong>gamma</strong> – The weighting factor for base pairs vs. unpaired nucleotides </p></li>
<li><p><strong>mea</strong> – A pointer to a variable where the MEA value will be written to </p></li>
</ul>
</dd>
<dt class="field-even">Pre</dt>
<dd class="field-even"><p><a class="reference internal" href="../partfunc/global.html#group__part__func__global_1gaff6fe7a499a62d62d10cb850d5222f00"><span class="std std-ref">vrna_pf()</span></a> must be executed on input parameter <code class="docutils literal notranslate"><span class="pre">fc</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An MEA structure (or NULL on any error)</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.vrna_MEA_from_plist">
<span class="target" id="group__mea__fold_1ga26afeef667f7013a743d1d1ebe42666a"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">vrna_MEA_from_plist</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/struct/plist.html#c.vrna_ep_t" title="vrna_ep_t"><span class="n"><span class="pre">vrna_ep_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">plist</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sequence</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">gamma</span></span>, <a class="reference internal" href="../grammar/model_details.html#c.vrna_md_t" title="vrna_md_t"><span class="n"><span class="pre">vrna_md_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">md</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mea</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.vrna_MEA_from_plist" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/MEA.h&gt;</em><p>Compute a MEA (maximum expected accuracy) structure from a list of probabilities. </p>
<p>The algorithm maximizes the expected accuracy</p>
<p><div class="math notranslate nohighlight">
\[ A(S) = \sum_{(i,j) \in S} 2 \gamma p_{ij} + \sum_{i \notin S} p^u_i \]</div>
</p>
<p>Higher values of <span class="math notranslate nohighlight">\(\gamma\)</span> result in more base pairs of lower probability and thus higher sensitivity. Low values of <span class="math notranslate nohighlight">\(\gamma\)</span> result in structures containing only highly likely pairs (high specificity). The code of the MEA function also demonstrates the use of sparse dynamic programming scheme to reduce the time and memory complexity of folding.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../wrappers.html#wrappers_1_wrappers000155"><span class="std std-ref"><span class="pre">SWIG</span> <span class="pre">Wrapper</span> <span class="pre">Notes:</span></span></a></dt>
<dd><p>This function is available as overloaded function <code class="docutils literal notranslate"><span class="pre">MEA_from_plist</span></code>(gamma = 1., md = NULL). Note, that it returns the MEA structure and MEA value as a tuple (MEA_structure, MEA). See, e.g.  <span><a class="reference internal" href="../api_python.html#RNA.MEA_from_plist" title="RNA.MEA_from_plist"><code class="xref py py-func docutils literal notranslate"><span class="pre">RNA.MEA_from_plist()</span></code></a> in the <a class="reference internal" href="../api_python.html"><span class="doc">Python API</span></a></span>. </p>
</dd></dl>

</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The unpaired probabilities <span class="math notranslate nohighlight">\(p^u_i = 1 - \sum_{j \neq i} p_{ij}\)</span> are usually computed from the supplied pairing probabilities <span class="math notranslate nohighlight">\(p_{ij}\)</span> as stored in <code class="docutils literal notranslate"><span class="pre">plist</span></code> entries of type <a class="reference internal" href="../utils/struct/plist.html#group__struct__utils__plist_1ga7c7484a8a1e6704b1aefaf589f3b27c1"><span class="std std-ref">VRNA_PLIST_TYPE_BASEPAIR</span></a>. To overwrite individual <span class="math notranslate nohighlight">\(p^u_o\)</span> values simply add entries with type <a class="reference internal" href="../utils/struct/plist.html#group__struct__utils__plist_1ga7961043acc4f183a7bc7cf2505a8c8b9"><span class="std std-ref">VRNA_PLIST_TYPE_UNPAIRED</span></a>
 To include G-Quadruplex support, the corresponding field in <code class="docutils literal notranslate"><span class="pre">md</span></code> must be set.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plist</strong> – A list of base pair probabilities the MEA structure is computed from </p></li>
<li><p><strong>sequence</strong> – The RNA sequence that corresponds to the list of probability values </p></li>
<li><p><strong>gamma</strong> – The weighting factor for base pairs vs. unpaired nucleotides </p></li>
<li><p><strong>md</strong> – A model details data structure (maybe NULL) </p></li>
<li><p><strong>mea</strong> – A pointer to a variable where the MEA value will be written to </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An MEA structure (or NULL on any error)</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.MEA">
<span class="target" id="group__mea__fold_1ga396ec6144c6a74fcbab4cea6b42d76c3"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MEA</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../utils/data_structures.html#c.plist" title="plist"><span class="n"><span class="pre">plist</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">p</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">structure</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">gamma</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.MEA" title="Permalink to this definition"></a><br /></dt>
<dd><em>#include &lt;ViennaRNA/MEA.h&gt;</em><p>Computes a MEA (maximum expected accuracy) structure. </p>
<p>The algorithm maximizes the expected accuracy</p>
<p><div class="math notranslate nohighlight">
\[ A(S) = \sum_{(i,j) \in S} 2 \gamma p_{ij} + \sum_{i \notin S} p^u_i \]</div>
</p>
<p>Higher values of <span class="math notranslate nohighlight">\(\gamma\)</span> result in more base pairs of lower probability and thus higher sensitivity. Low values of <span class="math notranslate nohighlight">\(\gamma\)</span> result in structures containing only highly likely pairs (high specificity). The code of the MEA function also demonstrates the use of sparse dynamic programming scheme to reduce the time and memory complexity of folding.</p>
<p><dl>
<dt class="sig sig-object cpp">
<a class="reference internal" href="../deprecated.html#deprecated_1_deprecated000089"><span class="std std-ref"><span class="pre">Deprecated:</span></span></a></dt>
<dd><p>Use <a class="reference internal" href="#group__mea__fold_1ga9b87b664ef014c1266aa50d5bc39f2ac"><span class="std std-ref">vrna_MEA()</span></a> or <a class="reference internal" href="#group__mea__fold_1ga26afeef667f7013a743d1d1ebe42666a"><span class="std std-ref">vrna_MEA_from_plist()</span></a> instead! </p>
</dd></dl>

</p>
</dd></dl>

</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="stochbt.html" class="btn btn-neutral float-left" title="Random Structure Samples from the Ensemble" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="centroid.html" class="btn btn-neutral float-right" title="Compute the Centroid Structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1994 - 2023, Ronny Lorenz, Ivo L. Hofacker, et al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>